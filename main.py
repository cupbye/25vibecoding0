'''
import streamlit as st
st.title('ë‚˜ì˜ ì²« streamlit app')
st.write('hello streamlit!!!')
'''

import streamlit as st

# MBTI ì§ˆë¬¸ ë° ì„ íƒì§€
# ê° ì§ˆë¬¸ì€ (ì§ˆë¬¸ ë‚´ìš©, ì„ íƒì§€1ì— í•´ë‹¹í•˜ëŠ” ìœ í˜•, ì„ íƒì§€2ì— í•´ë‹¹í•˜ëŠ” ìœ í˜•) í˜•íƒœë¡œ êµ¬ì„±
questions_data = {
    "EI": [
        ("í˜¼ì ìˆì„ ë•Œ ì—ë„ˆì§€ë¥¼ ì–»ëŠ”ë‹¤.", "I", "E"),
        ("ì—¬ëŸ¬ ì‚¬ëŒê³¼ í•¨ê»˜ ìˆì„ ë•Œ ì—ë„ˆì§€ë¥¼ ì–»ëŠ”ë‹¤.", "E", "I"),
        ("ê¸€ì“°ê¸°ë¥¼ í†µí•´ ìì‹ ì„ í‘œí˜„í•˜ëŠ” ê²ƒì´ ë” í¸í•˜ë‹¤.", "I", "E"),
        ("ë§ë¡œ ì§ì ‘ ì†Œí†µí•˜ëŠ” ê²ƒì„ ì„ í˜¸í•œë‹¤.", "E", "I"),
    ],
    "SN": [
        ("ì‹¤ì œ ê²½í—˜ê³¼ êµ¬ì²´ì ì¸ ì‚¬ì‹¤ì— ë” ì§‘ì¤‘í•œë‹¤.", "S", "N"),
        ("ë¯¸ë˜ì˜ ê°€ëŠ¥ì„±ê³¼ ì•„ì´ë””ì–´ë¥¼ ë” ì¤‘ìš”í•˜ê²Œ ìƒê°í•œë‹¤.", "N", "S"),
        ("í˜„ì¬ì— ì¶©ì‹¤í•˜ë©°, ì‹¤ìš©ì ì¸ ê²ƒì„ ì„ í˜¸í•œë‹¤.", "S", "N"),
        ("ìƒìƒë ¥ì´ í’ë¶€í•˜ë©°, ë¹„ìœ ì ì¸ í‘œí˜„ì„ ì¦ê²¨ ì‚¬ìš©í•œë‹¤.", "N", "S"),
    ],
    "TF": [
        ("ê²°ì •ì„ ë‚´ë¦´ ë•Œ ë…¼ë¦¬ì™€ ë¶„ì„ì„ ì¤‘ìš”í•˜ê²Œ ìƒê°í•œë‹¤.", "T", "F"),
        ("ê²°ì •ì„ ë‚´ë¦´ ë•Œ ì‚¬ëŒë“¤ê³¼ì˜ ê´€ê³„ì™€ ê°ì •ì„ ê³ ë ¤í•œë‹¤.", "F", "T"),
        ("ê°ê´€ì ì¸ ì‚¬ì‹¤ê³¼ ì›ì¹™ì„ ë°”íƒ•ìœ¼ë¡œ íŒë‹¨í•œë‹¤.", "T", "F"),
        ("íƒ€ì¸ì˜ ê°ì •ì— ê³µê°í•˜ê³  ì¡°í™”ë¥¼ ì¤‘ìš”í•˜ê²Œ ìƒê°í•œë‹¤.", "F", "T"),
    ],
    "JP": [
        ("ê³„íšì„ ì„¸ìš°ê³  ì²´ê³„ì ìœ¼ë¡œ ì¼ì„ ì§„í–‰í•˜ëŠ” ê²ƒì„ ì„ í˜¸í•œë‹¤.", "J", "P"),
        ("ìƒí™©ì— ë”°ë¼ ìœ ì—°í•˜ê²Œ ëŒ€ì²˜í•˜ê³  ì¦‰í¥ì ì¸ ê²ƒì„ ì¦ê¸´ë‹¤.", "P", "J"),
        ("ë§ˆê° ê¸°í•œì„ ì¤‘ìš”í•˜ê²Œ ìƒê°í•˜ê³  ë¯¸ë¦¬ ì¤€ë¹„í•œë‹¤.", "J", "P"),
        ("ììœ ë¡œìš´ í™˜ê²½ì—ì„œ ì¼í•˜ëŠ” ê²ƒì„ ì„ í˜¸í•˜ë©°, ë³€í™”ì— ì˜ ì ì‘í•œë‹¤.", "P", "J"),
    ]
}

# MBTI ìœ í˜•ë³„ ì„¤ëª… (ê°„ë‹¨í•˜ê²Œ ì˜ˆì‹œë¡œ ì‘ì„±)
mbti_descriptions = {
    "ISTJ": "ì±…ì„ê°ì´ ê°•í•˜ê³  í˜„ì‹¤ì ì¸ ìœ í˜•ì…ë‹ˆë‹¤. ì‹ ì¤‘í•˜ê³  ì§ˆì„œì •ì—°í•˜ë©°, ë§¡ì€ ì¼ì— ìµœì„ ì„ ë‹¤í•©ë‹ˆë‹¤.",
    "ISFJ": "í—Œì‹ ì ì´ê³  ì„±ì‹¤í•˜ë©°, íƒ€ì¸ì— ëŒ€í•œ ë°°ë ¤ì‹¬ì´ ê¹ŠìŠµë‹ˆë‹¤. ì•ˆì •ê°ì„ ì¤‘ìš”í•˜ê²Œ ìƒê°í•©ë‹ˆë‹¤.",
    "INFJ": "í†µì°°ë ¥ì´ ë›°ì–´ë‚˜ê³  ì´ìƒì£¼ì˜ì ì¸ ì„±í–¥ì„ ê°€ì§‘ë‹ˆë‹¤. íƒ€ì¸ì˜ ì„±ì¥ì„ ë•ëŠ” ë° ê´€ì‹¬ì´ ë§ìŠµë‹ˆë‹¤.",
    "INTJ": "ë…ë¦½ì ì´ê³  ë¶„ì„ì ì´ë©°, ë¹„ì „ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. ì „ëµì ì¸ ì‚¬ê³ ë¥¼ í•˜ë©° ëª©í‘œë¥¼ ì¶”êµ¬í•©ë‹ˆë‹¤.",
    "ISTP": "ë…¼ë¦¬ì ì´ê³  ì‹¤ìš©ì ì´ë©°, ë¬¸ì œ í•´ê²° ëŠ¥ë ¥ì´ ë›°ì–´ë‚©ë‹ˆë‹¤. í˜„ì¬ë¥¼ ì¦ê¸°ëŠ” ê²½í–¥ì´ ìˆìŠµë‹ˆë‹¤.",
    "ISFP": "ì˜¨í™”í•˜ê³  ê²¸ì†í•˜ë©°, í˜„ì¬ì˜ ì‚¶ì„ ì¦ê¹ë‹ˆë‹¤. ì˜ˆìˆ ì ì¸ ê°ê°ì´ ë›°ì–´ë‚˜ê³  ê´€ìš©ì ì…ë‹ˆë‹¤.",
    "INFP": "ì´ìƒì£¼ì˜ì ì´ê³  ì°½ì˜ì ì´ë©°, ìì‹ ì˜ ê°€ì¹˜ê´€ì„ ì¤‘ìš”í•˜ê²Œ ìƒê°í•©ë‹ˆë‹¤. íƒ€ì¸ì—ê²Œ ê³µê°í•˜ëŠ” ëŠ¥ë ¥ì´ ë›°ì–´ë‚©ë‹ˆë‹¤.",
    "INTP": "ì§€ì  í˜¸ê¸°ì‹¬ì´ ë§ê³  ë…¼ë¦¬ì ì´ë©°, ë¶„ì„ì ì¸ ì‚¬ê³ ë¥¼ í•©ë‹ˆë‹¤. ë…ë¦½ì ì´ê³  ë…ì°½ì ì¸ ì•„ì´ë””ì–´ë¥¼ ì¶”êµ¬í•©ë‹ˆë‹¤.",
    "ESTP": "í™œë™ì ì´ê³  í˜„ì‹¤ì ì´ë©°, ë¬¸ì œ í•´ê²°ì— ëŠ¥ìˆ™í•©ë‹ˆë‹¤. ìƒˆë¡œìš´ ê²½í—˜ì„ ì¦ê¸°ê³  ì ì‘ë ¥ì´ ë›°ì–´ë‚©ë‹ˆë‹¤.",
    "ESFP": "ì‚¬êµì ì´ê³  í™œë™ì ì´ë©°, í˜„ì¬ë¥¼ ì¦ê¸°ëŠ” ë‚™ì²œì ì¸ ìœ í˜•ì…ë‹ˆë‹¤. íƒ€ì¸ê³¼ì˜ ê´€ê³„ë¥¼ ì¤‘ìš”í•˜ê²Œ ìƒê°í•©ë‹ˆë‹¤.",
    "ENFP": "ì—´ì •ì ì´ê³  ìƒìƒë ¥ì´ í’ë¶€í•˜ë©°, ìƒˆë¡œìš´ ê°€ëŠ¥ì„±ì„ ì¶”êµ¬í•©ë‹ˆë‹¤. ì‚¬ëŒë“¤ê³¼ ì˜ ì–´ìš¸ë¦¬ê³  ë³€í™”ë¥¼ ì¦ê¹ë‹ˆë‹¤.",
    "ENTP": "ë…ì°½ì ì´ê³  ë…¼ë¦¬ì ì´ë©°, ìƒˆë¡œìš´ ì•„ì´ë””ì–´ë¥¼ íƒêµ¬í•˜ëŠ” ê²ƒì„ ì¢‹ì•„í•©ë‹ˆë‹¤. í† ë¡ ì„ ì¦ê¸°ê³  ë„ì „ì„ ë‘ë ¤ì›Œí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.",
    "ESTJ": "ì²´ê³„ì ì´ê³  í˜„ì‹¤ì ì´ë©°, ë¦¬ë”ì‹­ì´ ë›°ì–´ë‚©ë‹ˆë‹¤. ëª©í‘œ ì§€í–¥ì ì´ë©° ê²°ë‹¨ë ¥ì´ ìˆìŠµë‹ˆë‹¤.",
    "ESFJ": "ì‚¬êµì ì´ê³  ì¹œì ˆí•˜ë©°, íƒ€ì¸ì„ ë•ëŠ” ê²ƒì„ ì¢‹ì•„í•©ë‹ˆë‹¤. ì¡°í™”ë¡œìš´ ê´€ê³„ë¥¼ ì¤‘ìš”í•˜ê²Œ ìƒê°í•©ë‹ˆë‹¤.",
    "ENFJ": "ì—´ì •ì ì´ê³  ì±…ì„ê°ì´ ê°•í•˜ë©°, íƒ€ì¸ì˜ ì„±ì¥ì„ ë•ëŠ” ë° ëŠ¥ìˆ™í•©ë‹ˆë‹¤. ì‚¬ëŒë“¤ì—ê²Œ ì˜ê°ì„ ì£¼ëŠ” ë¦¬ë”ì…ë‹ˆë‹¤.",
    "ENTJ": "í†µì†”ë ¥ì´ ìˆê³  ê²°ë‹¨ë ¥ì´ ìˆìœ¼ë©°, ì¥ê¸°ì ì¸ ë¹„ì „ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. ëª©í‘œ ë‹¬ì„±ì„ ìœ„í•´ ë…¸ë ¥í•©ë‹ˆë‹¤."
}

def calculate_mbti(answers):
    """
    ì‚¬ìš©ìì˜ ë‹µë³€ì„ ë°”íƒ•ìœ¼ë¡œ MBTI ìœ í˜•ì„ ê³„ì‚°í•©ë‹ˆë‹¤.
    """
    scores = {"E": 0, "I": 0, "S": 0, "N": 0, "T": 0, "F": 0, "J": 0, "P": 0}
    for dimension_answers in answers.values():
        for answer in dimension_answers:
            scores[answer] += 1

    result = ""
    result += "E" if scores["E"] >= scores["I"] else "I"
    result += "S" if scores["S"] >= scores["N"] else "N"
    result += "T" if scores["T"] >= scores["F"] else "F"
    result += "J" if scores["J"] >= scores["P"] else "P"
    return result

def main():
    st.set_page_config(page_title="MBTI ì„±ê²© ìœ í˜• ê²€ì‚¬", layout="wide")
    st.title("ê°„ë‹¨ MBTI ì„±ê²© ìœ í˜• ê²€ì‚¬")
    st.write("ê° ì§ˆë¬¸ì— ëŒ€í•´ ìì‹ ì—ê²Œ ë” ê°€ê¹ë‹¤ê³  ìƒê°ë˜ëŠ” ë‹µë³€ì„ ì„ íƒí•´ì£¼ì„¸ìš”.")

    user_answers = {}
    all_questions_answered = True

    for dimension, qs in questions_data.items():
        st.subheader(f"--- {dimension[0]}/{dimension[1]} ì§€í‘œ ---")
        dimension_answers = []
        for i, (q_text, type1, type2) in enumerate(qs):
            # ê³ ìœ í•œ í‚¤ ìƒì„±ì„ ìœ„í•´ dimensionê³¼ ì§ˆë¬¸ ì¸ë±ìŠ¤ ì‚¬ìš©
            key = f"{dimension}_{i}"
            # st.radioì˜ ì˜µì…˜ì€ (í‘œì‹œë  í…ìŠ¤íŠ¸, ë°˜í™˜ë  ê°’)ì˜ íŠœí”Œ í˜•íƒœë¥¼ ê°€ì§ˆ ìˆ˜ ì—†ìœ¼ë¯€ë¡œ,
            # ì„ íƒ ì‹œ ë°˜í™˜ë  ê°’ì„ type1 ë˜ëŠ” type2ë¡œ ì§ì ‘ ì§€ì •
            options = [f"A. {q_text.split(' ')[0]} ...", f"B. {q_text.split(' ')[0]} ..."] # ê°„ëµí•œ ì˜µì…˜ í‘œì‹œ
            
            # ë¼ë””ì˜¤ ë²„íŠ¼ì˜ ì„ íƒì§€ë¥¼ í…ìŠ¤íŠ¸ë¡œ í•˜ê³ , ì„ íƒëœ í…ìŠ¤íŠ¸ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìœ í˜•ì„ ê²°ì •
            # ì‚¬ìš©ìì—ê²ŒëŠ” ì§ˆë¬¸ì˜ í•µì‹¬ ë‚´ìš©ê³¼ ì„ íƒì§€ A/Bë§Œ ë³´ì—¬ì£¼ë„ë¡ ìˆ˜ì •
            question_prompt = f"**{i+1}. {q_text}**"
            
            # ì„ íƒì§€ êµ¬ì„± ë°©ì‹ ë³€ê²½: ì‚¬ìš©ìê°€ ì§ì ‘ ì„ íƒì§€ë¥¼ ì½ê³  A/Bë¥¼ ê³ ë¥´ë„ë¡ ì•ˆë‚´
            # ì‹¤ì œ ì§ˆë¬¸ì€ ìœ„ì— í‘œì‹œí•˜ê³ , ì„ íƒì€ A/Bë¡œë§Œ ë°›ë„ë¡ ê°„ì†Œí™”
            # ì´ ë°©ì‹ ëŒ€ì‹ , ê° ì„ íƒì§€ë¥¼ ëª…í™•íˆ í‘œì‹œí•˜ëŠ” ê²ƒì´ ì‚¬ìš©ì ê²½í—˜ì— ë” ì¢‹ìŠµë‹ˆë‹¤.
            # ì•„ë˜ëŠ” ê° ì„ íƒì§€ë¥¼ ë²„íŠ¼ì˜ ë ˆì´ë¸”ë¡œ ì‚¬ìš©í•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.

            option_a_text = f"ì„ íƒ 1 ({type1})"
            option_b_text = f"ì„ íƒ 2 ({type2})"

            # ì§ˆë¬¸ë§ˆë‹¤ ê³ ìœ í•œ í‚¤ë¥¼ ë¶€ì—¬í•´ì•¼ í•¨
            answer_choice = st.radio(
                question_prompt,
                (option_a_text, option_b_text),
                key=key,
                horizontal=True, # ê°€ë¡œ ì •ë ¬
                index=None # ê¸°ë³¸ ì„ íƒ ì—†ìŒ
            )

            if answer_choice == option_a_text:
                dimension_answers.append(type1)
            elif answer_choice == option_b_text:
                dimension_answers.append(type2)
            else:
                all_questions_answered = False # í•˜ë‚˜ë¼ë„ ë‹µë³€ ì•ˆí•˜ë©´ False

        user_answers[dimension] = dimension_answers

    st.markdown("---")

    if st.button("ê²°ê³¼ ë³´ê¸°", disabled=not all_questions_answered):
        if not all_questions_answered:
            st.warning("ëª¨ë“  ì§ˆë¬¸ì— ë‹µë³€í•´ì£¼ì„¸ìš”.")
        else:
            # ë‹µë³€ í†µí•© (ê° ì§€í‘œë³„ë¡œ E,I,S,N,T,F,J,P ì¤‘ ì–´ë–¤ ê²ƒì„ ì„ íƒí–ˆëŠ”ì§€ ë¦¬ìŠ¤íŠ¸ë¡œ ë§Œë“¦)
            flat_answers = {"EI": [], "SN": [], "TF": [], "JP": []}
            for dim_key, dim_ans_list in user_answers.items():
                for ans_val in dim_ans_list:
                    flat_answers[dim_key].append(ans_val)


            final_mbti_type = calculate_mbti(flat_answers)
            st.subheader(f"ğŸ‰ ë‹¹ì‹ ì˜ MBTI ìœ í˜•ì€: {final_mbti_type} ğŸ‰")
            st.markdown(f"**{final_mbti_type} ìœ í˜• ì„¤ëª…:**")
            st.info(mbti_descriptions.get(final_mbti_type, "ê²°ê³¼ ì„¤ëª…ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."))
            st.balloons()
    elif not all_questions_answered:
        st.info("ëª¨ë“  ì§ˆë¬¸ì— ë‹µë³€ í›„ 'ê²°ê³¼ ë³´ê¸°' ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.")


if __name__ == "__main__":
    main()
